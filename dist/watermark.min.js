!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.waterMarker=r():e.waterMarker=r()}(self,(()=>(()=>{var e=[,(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.rotate=r.fullMarker=r.QRcode=r.blur=r.mosaic=r.imgWaterMarker=void 0;var n=t(2);Object.defineProperty(r,"imgWaterMarker",{enumerable:!0,get:function(){return n.imgWaterMarker}});var o=t(8);Object.defineProperty(r,"mosaic",{enumerable:!0,get:function(){return o.mosaic}});var a=t(10);Object.defineProperty(r,"blur",{enumerable:!0,get:function(){return a.blur}});var i=t(11);Object.defineProperty(r,"QRcode",{enumerable:!0,get:function(){return i.QRcode}});var c=t(13);Object.defineProperty(r,"fullMarker",{enumerable:!0,get:function(){return c.fullMarker}});var u=t(14);Object.defineProperty(r,"rotate",{enumerable:!0,get:function(){return u.rotate}})},function(e,r,t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,r,t,n){void 0===n&&(n=t);var o=Object.getOwnPropertyDescriptor(r,t);o&&!("get"in o?!r.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,o)}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]}),o=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&n(r,e,t);return o(r,e),r},i=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))((function(o,a){function i(e){try{u(n.next(e))}catch(e){a(e)}}function c(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,c)}u((n=n.apply(e,r||[])).next())}))},c=this&&this.__generator||function(e,r){var t,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.imgWaterMarker=void 0;var u=t(3),f=t(5),l=a(t(7));r.imgWaterMarker=function(e){var r=this;return new Promise((function(t,n){return i(r,void 0,void 0,(function(){var r,o,a,i,s,h,d,v,p,b,g,y,w,m,_,k,x,P,O,M,j,I,E;return c(this,(function(c){switch(c.label){case 0:return function(e,r){if(!e.src)throw(0,l.error)("请输入图片地址"),r("请输入图片地址"),new l.default(1,"configError");e.text||(0,l.warn)("请配置水印文字");if(!["","png","jpeg"].includes(e.output||""))throw(0,l.error)("不支持".concat(e.output,"类型")),r("不支持".concat(e.output,"类型")),new l.default(1,"configError")}(e,n),r=(0,u.createCanvas)(),o=r.canvas,a=r.ctx,i=e.src,s=e.text,h=e.size,d=void 0===h?20:h,v=e.color,p=void 0===v?"#c0c0c0":v,b=e.padding,g=void 0===b?30:b,y=e.output,w=void 0===y?"jpeg":y,m=e.position,_=void 0===m?"RIGHT_BOTTOM":m,k=e.rotate,x=void 0===k?0:k,P=e.type,O=void 0===P?"fill":P,[4,(0,u.createImgInstance)({source:i,canvas:o,onError:function(){return(0,l.error)("注意-一个无法打开的图片资源")}})];case 1:return M=c.sent(),j=M.width,I=M.height,o.width=j,o.height=I,a.drawImage(M,0,0,j,I),a.font="".concat(d,"px bold italic arial"),(E=a.createLinearGradient(100,200,200,200)).addColorStop(1,p),a.fillStyle=E,function(e,r,t,n,o,a,i,c){void 0===n&&(n=30);var u=(0,f.getTextBound)(e,r||"Jimmy定制");if(o<u.width+n||a<u.height+n)throw(0,l.error)("图片太小或水印文字太大"),new l.default(2,"图片太小或水印文字太大");var s=0,h=0;switch((0,f.getPositionType)(t)){case 1:s=n,h=n;break;case 2:s=n,h=a/2-u.height/2;break;case 3:s=n,h=a-u.height-n;break;case 4:s=o/2-u.width/2,h=n;break;case 5:s=o/2-u.width/2,h=a/2-u.height/2;break;case 6:s=o/2-u.width/2,h=a-u.height-n;break;case 7:s=o-u.width-n,h=n;break;case 8:s=o-u.width-n,h=a/2-u.height/2;break;case 9:s=o-u.width-n,h=a-u.height-n}if(c){var d={x:s+u.width/2,y:h+u.height/2};e.translate(d.x,d.y),e.rotate(c*Math.PI/180),e.translate(-d.x,-d.y)}"fill"===i?e.fillText(r||"watermark",s,h):e.strokeText(r||"watermark",s,h)}(a,s,_,g,j,I,O,x),t(o.toDataURL("image/".concat(w))),[2]}}))}))}))}},(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createImgInstance=r.createCanvas=void 0;var n=t(4);Object.defineProperty(r,"createCanvas",{enumerable:!0,get:function(){return n.createCanvas}});var o=t(6);Object.defineProperty(r,"createImgInstance",{enumerable:!0,get:function(){return o.createImgInstance}})},(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createCanvas=void 0;var n=t(5);r.createCanvas=function(){var e,r;return r=(0,n.isMiniProgram)()?(e=wx.createOffscreenCanvas({type:"2d"})).getContext("2d"):(e=document.createElement("canvas")).getContext("2d"),{canvas:e,ctx:r}}},(e,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isMiniProgram=r.gaussBlur=r.getPositionType=r.getTextBound=void 0;r.getTextBound=function(e,r){var t=e.measureText(r);return{width:t.width,height:t.actualBoundingBoxDescent}};r.getPositionType=function(e){var r;switch(e){case"LEFT_TOP":r=1;break;case"LEFT_CENTER":r=2;break;case"LEFT_BOTTOM":r=3;break;case"CENTER_TOP":r=4;break;case"CENTER":r=5;break;case"CENTER_BOTTOM":r=6;break;case"RIGHT_TOP":r=7;break;case"RIGHT_CENTER":r=8;break;case"RIGHT_BOTTOM":r=9}return r},r.gaussBlur=function(e,r){r*=3;var t,n,o,a,i,c,u,f,l,s,h=new Uint8ClampedArray(e.data),d=e.width,v=e.height,p=[],b=0,g=(r=Math.floor(r))/3;for(c=1/(Math.sqrt(2*Math.PI)*g),i=-1/(2*g*g),u=-r;u<=r;u++)p.push(c*Math.exp(i*u*u));for(n=0;n<v;n++)for(t=0;t<d;t++){for(o=a=i=c=b=0,f=-r;f<=r;f++)(l=t+f)>=0&&l<d&&(u=4*(n*d+l),s=p[f+r],o+=h[u]*s,a+=h[u+1]*s,i+=h[u+2]*s,c+=h[u+3]*s,b+=s);u=4*(n*d+t),e.data.set([o,a,i,c].map((function(e){return e/b})),u)}for(h.set(e.data),t=0;t<d;t++)for(n=0;n<v;n++){for(o=a=i=c=b=0,f=-r;f<=r;f++)(l=n+f)>=0&&l<v&&(u=4*(l*d+t),s=p[f+r],o+=h[u]*s,a+=h[u+1]*s,i+=h[u+2]*s,c+=h[u+3]*s,b+=s);u=4*(n*d+t),e.data.set([o,a,i,c].map((function(e){return e/b})),u)}return e},r.isMiniProgram=function(){return!!window.wx}},(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createImgInstance=void 0;var n=t(5);r.createImgInstance=function(e){var r=e.source,t=e.onError,o=e.canvas;return new Promise((function(e,a){var i;(i=(0,n.isMiniProgram)()?o.createImage():new Image).setAttribute("crossOrigin",""),i.src=r,i.onload=function(){e(i)},i.onerror=function(){t(),a("资源加载失败")}}))}},function(e,r){"use strict";var t,n,o=this&&this.__extends||(t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])},t(e,r)},function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(r,"__esModule",{value:!0}),r.error=r.warn=void 0,function(e){e[e.ConfigError=1]="ConfigError",e[e.RenderError=2]="RenderError",e[e.SourceError=3]="SourceError"}(n||(n={}));r.warn=function(e){};r.error=function(e){};var a=function(e){function r(r,t){var o=e.call(this)||this;switch(r){case n.ConfigError:o.name=n[n.ConfigError],o.message=t;break;case n.RenderError:o.name=n[n.RenderError],o.message=t;break;case n.SourceError:o.name=n[n.SourceError],o.message=t}return o}return o(r,e),r}(Error);r.default=a},function(e,r,t){"use strict";var n=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))((function(o,a){function i(e){try{u(n.next(e))}catch(e){a(e)}}function c(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,c)}u((n=n.apply(e,r||[])).next())}))},o=this&&this.__generator||function(e,r){var t,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.mosaic=void 0;var a=t(3),i=t(9);r.mosaic=function(e){var r=this,t=e.src,c=e.output,u=void 0===c?"jpeg":c,f=e.size,l=void 0===f?8:f;return new Promise((function(e,c){return n(r,void 0,void 0,(function(){var r,n,c,f,s,h,d,v,p,b,g,y,w,m,_;return o(this,(function(o){switch(o.label){case 0:return r=(0,a.createCanvas)(),n=r.canvas,c=r.ctx,[4,(0,a.createImgInstance)({source:t,canvas:n,onError:function(){return(0,i.error)("注意-一个无法打开的图片资源")}})];case 1:for(f=o.sent(),s=f.width,h=f.height,n.width=s,n.height=h,c.drawImage(f,0,0,s,h),d=c.getImageData(0,0,s,h),v=d.data,c.fillRect(0,0,s,h),p=0;p<h;p+=l)for(b=0;b<s;b+=l)y=[v[g=4*(p*s+b)],v[g+1],v[g+2]],w=y[0],m=y[1],_=y[2],c.fillStyle="rgb(".concat(w,",").concat(m,",").concat(_,")"),c.beginPath(),c.arc(b,p,l/2,0,2*Math.PI),c.fill();return e(n.toDataURL("image/".concat(u))),[2]}}))}))}))}},(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.error=void 0;var n=t(7);Object.defineProperty(r,"error",{enumerable:!0,get:function(){return n.error}})},function(e,r,t){"use strict";var n=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))((function(o,a){function i(e){try{u(n.next(e))}catch(e){a(e)}}function c(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,c)}u((n=n.apply(e,r||[])).next())}))},o=this&&this.__generator||function(e,r){var t,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.blur=void 0;var a=t(6),i=t(4),c=t(7),u=t(5);r.blur=function(e){var r=this,t=e.src,f=e.output,l=void 0===f?"jpeg":f,s=e.radius,h=void 0===s?5:s;return new Promise((function(e,f){return n(r,void 0,void 0,(function(){var r,n,f,s,d,v,p,b;return o(this,(function(o){switch(o.label){case 0:return r=(0,i.createCanvas)(),n=r.canvas,f=r.ctx,[4,(0,a.createImgInstance)({source:t,canvas:n,onError:function(){return(0,c.error)("注意-一个无法打开的图片资源")}})];case 1:return s=o.sent(),d=s.width,v=s.height,n.width=d,n.height=v,f.drawImage(s,0,0,d,v),p=f.getImageData(0,0,d,v),b=(0,u.gaussBlur)(p,h),f.putImageData(b,0,0),e(n.toDataURL("image/".concat(l))),[2]}}))}))}))}},function(e,r,t){"use strict";var n=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))((function(o,a){function i(e){try{u(n.next(e))}catch(e){a(e)}}function c(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,c)}u((n=n.apply(e,r||[])).next())}))},o=this&&this.__generator||function(e,r){var t,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.QRcode=void 0;var a=t(3),i=t(9),c=t(12);r.QRcode=function(e){var r=this,t=e.src,u=e.output,f=void 0===u?"jpeg":u,l=e.source,s=e.codeSize,h=void 0===s?400:s,d=e.size,v=void 0===d?100:d,p=e.colorDark,b=void 0===p?"#000":p,g=e.colorLight,y=void 0===g?"#fff":g,w=e.correctLevel,m=void 0===w?2:w;return new Promise((function(e,u){return n(r,void 0,void 0,(function(){var r,n,u,s;return o(this,(function(o){switch(o.label){case 0:return r=(0,a.createCanvas)(),n=r.canvas,u=r.ctx,n.width=h,n.height=h,c.api.draw(l,u,0,0,h,h,y,b,"",m),t?[4,(0,a.createImgInstance)({source:t,canvas:n,onError:function(){return(0,i.error)("注意-一个无法打开的图片资源")}})]:[3,2];case 1:s=o.sent(),u.drawImage(s,h/2-v/2,h/2-v/2,v,v),o.label=2;case 2:return e(n.toDataURL("image/".concat(f))),[2]}}))}))}))}},e=>{!function(){var r,t,n,o,a,i,c=[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28],u=[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177],f=[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],l=[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],s=[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175],h=[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],d=[],v=[],p=[],b=[],g=[],y=2;function w(e,r){var t;e>r&&(t=e,e=r,r=t),t=r,t*=r,t+=r,t>>=1,b[t+=e]=1}function m(e,r){var n;for(p[e+t*r]=1,n=-2;n<2;n++)p[e+n+t*(r-2)]=1,p[e-2+t*(r+n+1)]=1,p[e+2+t*(r+n)]=1,p[e+n+1+t*(r+2)]=1;for(n=0;n<2;n++)w(e-1,r+n),w(e+1,r-n),w(e-n,r-1),w(e+n,r+1)}function _(e){for(;e>=255;)e=((e-=255)>>8)+(255&e);return e}var k=[];function x(e,r,t,n){var o,a,i;for(o=0;o<n;o++)d[t+o]=0;for(o=0;o<r;o++){if(255!=(i=s[d[e+o]^d[t]]))for(a=1;a<n;a++)d[t+a-1]=d[t+a]^h[_(i+k[n-a])];else for(a=t;a<t+n;a++)d[a]=d[a+1];d[t+n-1]=255==i?0:h[_(i+k[0])]}}function P(e,r){var t;return e>r&&(t=e,e=r,r=t),t=r,t+=r*r,t>>=1,b[t+=e]}function O(e){var r,n,o,a;switch(e){case 0:for(n=0;n<t;n++)for(r=0;r<t;r++)r+n&1||P(r,n)||(p[r+n*t]^=1);break;case 1:for(n=0;n<t;n++)for(r=0;r<t;r++)1&n||P(r,n)||(p[r+n*t]^=1);break;case 2:for(n=0;n<t;n++)for(o=0,r=0;r<t;r++,o++)3==o&&(o=0),o||P(r,n)||(p[r+n*t]^=1);break;case 3:for(a=0,n=0;n<t;n++,a++)for(3==a&&(a=0),o=a,r=0;r<t;r++,o++)3==o&&(o=0),o||P(r,n)||(p[r+n*t]^=1);break;case 4:for(n=0;n<t;n++)for(o=0,a=n>>1&1,r=0;r<t;r++,o++)3==o&&(o=0,a=!a),a||P(r,n)||(p[r+n*t]^=1);break;case 5:for(a=0,n=0;n<t;n++,a++)for(3==a&&(a=0),o=0,r=0;r<t;r++,o++)3==o&&(o=0),(r&n&1)+!(!o|!a)||P(r,n)||(p[r+n*t]^=1);break;case 6:for(a=0,n=0;n<t;n++,a++)for(3==a&&(a=0),o=0,r=0;r<t;r++,o++)3==o&&(o=0),(r&n&1)+(o&&o==a)&1||P(r,n)||(p[r+n*t]^=1);break;case 7:for(a=0,n=0;n<t;n++,a++)for(3==a&&(a=0),o=0,r=0;r<t;r++,o++)3==o&&(o=0),(o&&o==a)+(r+n&1)&1||P(r,n)||(p[r+n*t]^=1)}}function M(e){var r,t=0;for(r=0;r<=e;r++)g[r]>=5&&(t+=3+g[r]-5);for(r=3;r<e-1;r+=2)g[r-2]==g[r+2]&&g[r+2]==g[r-1]&&g[r-1]==g[r+1]&&3*g[r-1]==g[r]&&(0==g[r-3]||r+3>e||3*g[r-3]>=4*g[r]||3*g[r+3]>=4*g[r])&&(t+=40);return t}function j(){var e,r,n,o,a,i=0,c=0;for(r=0;r<t-1;r++)for(e=0;e<t-1;e++)(p[e+t*r]&&p[e+1+t*r]&&p[e+t*(r+1)]&&p[e+1+t*(r+1)]||!(p[e+t*r]||p[e+1+t*r]||p[e+t*(r+1)]||p[e+1+t*(r+1)]))&&(i+=3);for(r=0;r<t;r++){for(g[0]=0,n=o=e=0;e<t;e++)(a=p[e+t*r])==o?g[n]++:g[++n]=1,c+=(o=a)?1:-1;i+=M(n)}c<0&&(c=-c);var u=c,f=0;for(u+=u<<2,u<<=1;u>t*t;)u-=t*t,f++;for(i+=10*f,e=0;e<t;e++){for(g[0]=0,n=o=r=0;r<t;r++)(a=p[e+t*r])==o?g[n]++:g[++n]=1,o=a;i+=M(n)}return i}var I=null,E={get ecclevel(){return y},set ecclevel(e){y=e},get size(){return _size},set size(e){_size=e},get canvas(){return I},set canvas(e){I=e},getFrame:function(e){return function(e){var g,M,I,E,T,C,R,S;E=e.length,r=0;do{if(r++,I=4*(y-1)+16*(r-1),n=l[I++],o=l[I++],a=l[I++],i=l[I],E<=(I=a*(n+o)+o-3+(r<=9)))break}while(r<40);for(t=17+4*r,T=a+(a+i)*(n+o)+o,E=0;E<T;E++)v[E]=0;for(d=e.slice(0),E=0;E<t*t;E++)p[E]=0;for(E=0;E<(t*(t+1)+1)/2;E++)b[E]=0;for(E=0;E<3;E++){for(I=0,M=0,1==E&&(I=t-7),2==E&&(M=t-7),p[M+3+t*(I+3)]=1,g=0;g<6;g++)p[M+g+t*I]=1,p[M+t*(I+g+1)]=1,p[M+6+t*(I+g)]=1,p[M+g+1+t*(I+6)]=1;for(g=1;g<5;g++)w(M+g,I+1),w(M+1,I+g+1),w(M+5,I+g),w(M+g+1,I+5);for(g=2;g<4;g++)p[M+g+t*(I+2)]=1,p[M+2+t*(I+g+1)]=1,p[M+4+t*(I+g)]=1,p[M+g+1+t*(I+4)]=1}if(r>1)for(E=c[r],M=t-7;;){for(g=t-7;g>E-3&&(m(g,M),!(g<E));)g-=E;if(M<=E+9)break;m(6,M-=E),m(M,6)}for(p[8+t*(t-8)]=1,M=0;M<7;M++)w(7,M),w(t-8,M),w(7,M+t-7);for(g=0;g<8;g++)w(g,7),w(g+t-8,7),w(g,t-8);for(g=0;g<9;g++)w(g,8);for(g=0;g<8;g++)w(g+t-8,8),w(8,g);for(M=0;M<7;M++)w(8,M+t-7);for(g=0;g<t-14;g++)1&g?(w(8+g,6),w(6,8+g)):(p[8+g+6*t]=1,p[6+t*(8+g)]=1);if(r>6)for(E=u[r-7],I=17,g=0;g<6;g++)for(M=0;M<3;M++,I--)1&(I>11?r>>I-12:E>>I)?(p[5-g+t*(2-M+t-11)]=1,p[2-M+t-11+t*(5-g)]=1):(w(5-g,2-M+t-11),w(2-M+t-11,5-g));for(M=0;M<t;M++)for(g=0;g<=M;g++)p[g+t*M]&&w(g,M);for(T=d.length,C=0;C<T;C++)v[C]=d.charCodeAt(C);if(d=v.slice(0),T>=(g=a*(n+o)+o)-2&&(T=g-2,r>9&&T--),C=T,r>9){for(d[C+2]=0,d[C+3]=0;C--;)E=d[C],d[C+3]|=255&E<<4,d[C+2]=E>>4;d[2]|=255&T<<4,d[1]=T>>4,d[0]=64|T>>12}else{for(d[C+1]=0,d[C+2]=0;C--;)E=d[C],d[C+2]|=255&E<<4,d[C+1]=E>>4;d[1]|=255&T<<4,d[0]=64|T>>4}for(C=T+3-(r<10);C<g;)d[C++]=236,d[C++]=17;for(k[0]=1,C=0;C<i;C++){for(k[C+1]=1,R=C;R>0;R--)k[R]=k[R]?k[R-1]^h[_(s[k[R]]+C)]:k[R-1];k[0]=h[_(s[k[0]]+C)]}for(C=0;C<=i;C++)k[C]=s[k[C]];for(I=g,M=0,C=0;C<n;C++)x(M,a,I,i),M+=a,I+=i;for(C=0;C<o;C++)x(M,a+1,I,i),M+=a+1,I+=i;for(M=0,C=0;C<a;C++){for(R=0;R<n;R++)v[M++]=d[C+R*a];for(R=0;R<o;R++)v[M++]=d[n*a+C+R*(a+1)]}for(R=0;R<o;R++)v[M++]=d[n*a+C+R*(a+1)];for(C=0;C<i;C++)for(R=0;R<n+o;R++)v[M++]=d[g+C+R*i];for(d=v,g=M=t-1,I=T=1,S=(a+i)*(n+o)+o,C=0;C<S;C++)for(E=d[C],R=0;R<8;R++,E<<=1){128&E&&(p[g+t*M]=1);do{T?g--:(g++,I?0!=M?M--:(I=!I,6==(g-=2)&&(g--,M=9)):M!=t-1?M++:(I=!I,6==(g-=2)&&(g--,M-=8))),T=!T}while(P(g,M))}for(d=p.slice(0),E=0,M=3e4,I=0;I<8&&(O(I),(g=j())<M&&(M=g,E=I),7!=E);I++)p=d.slice(0);for(E!=I&&O(E),M=f[E+(y-1<<3)],I=0;I<8;I++,M>>=1)1&M&&(p[t-1-I+8*t]=1,I<6?p[8+t*I]=1:p[8+t*(I+1)]=1);for(I=0;I<7;I++,M>>=1)1&M&&(p[8+t*(t-7+I)]=1,I?p[6-I+8*t]=1:p[7+8*t]=1);return p}(e)},utf16to8:function(e){var r,t,n,o;for(r="",n=e.length,t=0;t<n;t++)(o=e.charCodeAt(t))>=1&&o<=127?r+=e.charAt(t):o>2047?(r+=String.fromCharCode(224|o>>12&15),r+=String.fromCharCode(128|o>>6&63),r+=String.fromCharCode(128|o>>0&63)):(r+=String.fromCharCode(192|o>>6&31),r+=String.fromCharCode(128|o>>0&63));return r},draw:function(e,r,n,o,a,i,c,u,f,l){if(y=l||y,r){var s=Math.min(a,i);e=this.utf16to8(e);var h=this.getFrame(e),d=s/t;c&&(r.fillStyle=c,r.fillRect(n,o,a,a)),r.fillStyle=u||"black";for(var v=0;v<t;v++)for(var p=0;p<t;p++)h[p*t+v]&&r.fillRect(n+d*v,o+d*p,d,d)}}};e.exports={api:E}}()},function(e,r,t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,r,t,n){void 0===n&&(n=t);var o=Object.getOwnPropertyDescriptor(r,t);o&&!("get"in o?!r.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,o)}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]}),o=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&n(r,e,t);return o(r,e),r},i=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))((function(o,a){function i(e){try{u(n.next(e))}catch(e){a(e)}}function c(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,c)}u((n=n.apply(e,r||[])).next())}))},c=this&&this.__generator||function(e,r){var t,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.fullMarker=void 0;var u=t(3),f=t(5),l=a(t(7));r.fullMarker=function(e){var r=this;return new Promise((function(t,n){return i(r,void 0,void 0,(function(){var r,o,a,i,s,h,d,v,p,b,g,y,w,m,_,k,x,P,O,M,j;return c(this,(function(c){switch(c.label){case 0:return function(e,r){if(!e.src)throw(0,l.error)("请输入图片地址"),r("请输入图片地址"),new l.default(1,"configError");e.text||(0,l.warn)("请配置水印文字");if(!["","png","jpeg"].includes(e.output||""))throw(0,l.error)("不支持".concat(e.output,"类型")),r("不支持".concat(e.output,"类型")),new l.default(1,"configError")}(e,n),r=e.src,o=e.text,a=e.size,i=void 0===a?20:a,s=e.color,h=void 0===s?"#c0c0c0":s,d=e.padding,v=void 0===d?20:d,p=e.output,b=void 0===p?"jpeg":p,g=e.rotate,y=void 0===g?0:g,w=e.type,m=void 0===w?"fill":w,_=(0,u.createCanvas)(),k=_.canvas,x=_.ctx,[4,(0,u.createImgInstance)({source:r,canvas:k,onError:function(){return(0,l.error)("注意-一个无法打开的图片资源")}})];case 1:return P=c.sent(),O=P.width,M=P.height,k.width=O,k.height=M,x.drawImage(P,0,0,O,M),x.font="".concat(i,"px bold italic arial"),(j=x.createLinearGradient(100,200,200,200)).addColorStop(1,h),x.fillStyle=j,function(e,r,t,n,o,a,i){void 0===t&&(t=30);var c=(0,f.getTextBound)(e,r||"Jimmy定制");if(n<c.width+t||o<c.height+t)throw(0,l.error)("图片太小或水印文字太大"),new l.default(2,"图片太小或水印文字太大");var u=0,s=0;if(i){var h={x:u+c.width/2,y:s+c.height/2};e.translate(h.x,h.y),e.rotate(i*Math.PI/180),e.translate(-h.x,-h.y)}var d=function(i,f){i<n?("fill"===a?e.fillText(r||"watermark",u+i,s+f):e.strokeText(r||"watermark",u+i,s+f),i+=c.width+t,d(i,f)):f<o&&(f+=2*c.height+t,d(i=0,f))};d(0,0)}(x,o,v,O,M,m,y),t(k.toDataURL("image/".concat(b))),[2]}}))}))}))}},function(e,r,t){"use strict";var n=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))((function(o,a){function i(e){try{u(n.next(e))}catch(e){a(e)}}function c(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,c)}u((n=n.apply(e,r||[])).next())}))},o=this&&this.__generator||function(e,r){var t,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.rotate=void 0;var a=t(7),i=t(4),c=t(6);r.rotate=function(e){var r=this,t=e.src,u=e.rotate,f=e.output,l=void 0===f?"png":f,s=e.symmetric;return new Promise((function(e,f){return n(r,void 0,void 0,(function(){var r,n,h,d,v,p,b;return o(this,(function(o){switch(o.label){case 0:return r=(0,i.createCanvas)(),n=r.canvas,h=r.ctx,[4,(0,c.createImgInstance)({source:t,canvas:n,onError:function(){(0,a.error)("注意-一个无法打开的图片资源"),f("注意-一个无法打开的图片资源")}})];case 1:return d=o.sent(),v=d.width,p=d.height,n.width=v,n.height=p,b={x:v/2,y:p/2},h.translate(b.x,b.y),h.rotate(u*Math.PI/180),h.translate(-b.x,-b.y),h.drawImage(d,0,0,v,p),s&&("row"===s?function(e,r){for(var t=r.getImageData(0,0,e.width,e.height),n=t.data,o=e.height,a=e.width,i=Math.floor(o/2),c=4*a,u=0;u<i;u++)for(var f=u*c,l=(o-u-1)*c;f<c*(u+1);f+=4,l+=4){var s=n[f],h=n[f+1],d=n[f+2],v=n[f+3];n[f]=n[l],n[f+1]=n[l+1],n[f+2]=n[l+2],n[f+3]=n[l+3],n[l]=s,n[l+1]=h,n[l+2]=d,n[l+3]=v}r.putImageData(t,0,0)}(n,h):"column"===s?function(e,r){for(var t=r.getImageData(0,0,e.width,e.height),n=t.data,o=4*e.width,a=0;a<n.length;a+=4){var i=n[a],c=n[a+1],u=n[a+2],f=n[a+3];if(a%o<o/2){var l=a+(o-a%o*2);n[a]=n[l],n[a+1]=n[l+1],n[a+2]=n[l+2],n[a+3]=n[l+3],n[l]=i,n[l+1]=c,n[l+2]=u,n[l+3]=f}}r.putImageData(t,0,0)}(n,h):((0,a.error)("注意-错误的 symmetric 参数"),f("注意-错误的 symmetric 参数"))),e(n.toDataURL("image/".concat(l))),[2]}}))}))}))}}],r={};function t(n){var o=r[n];if(void 0!==o)return o.exports;var a=r[n]={exports:{}};return e[n].call(a.exports,a,a.exports,t),a.exports}var n={};return(()=>{"use strict";var e=n;Object.defineProperty(e,"__esModule",{value:!0}),e.rotate=e.fullMarker=e.QRcode=e.blur=e.mosaic=e.marker=void 0;var r=t(1);Object.defineProperty(e,"marker",{enumerable:!0,get:function(){return r.imgWaterMarker}}),Object.defineProperty(e,"mosaic",{enumerable:!0,get:function(){return r.mosaic}}),Object.defineProperty(e,"blur",{enumerable:!0,get:function(){return r.blur}}),Object.defineProperty(e,"QRcode",{enumerable:!0,get:function(){return r.QRcode}}),Object.defineProperty(e,"fullMarker",{enumerable:!0,get:function(){return r.fullMarker}}),Object.defineProperty(e,"rotate",{enumerable:!0,get:function(){return r.rotate}}),e.default={marker:r.imgWaterMarker,mosaic:r.mosaic,blur:r.blur,QRcode:r.QRcode,fullMarker:r.fullMarker,rotate:r.rotate}})(),n=n.default})()));